"use strict";function _defineProperty(e,t,i){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PictView=e()}}((function(){return function e(t,i,o){function n(r,a){if(!i[r]){if(!t[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(s)return s(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[r]={exports:{}};t[r][0].call(d.exports,(function(e){return n(t[r][1][e]||e)}),d,d.exports,e,t,i,o)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(e,t,i){class o{constructor(e,t){this.fable=!1,this.options="object"==typeof e?e:{},this.serviceType="Unknown",this.UUID="CORESVC-".concat(Math.floor(89999*Math.random()+1e4)),this.Hash="string"==typeof t?t:"".concat(this.UUID)}connectFable(e){return this.fable=e,!0}}_defineProperty(o,"isFableService",!0),t.exports=o},{}],2:[function(e,t,i){class o{constructor(e,t,i){this.fable=e,this.options="object"==typeof t?t:"object"!=typeof e||e.isFable?{}:e,this.serviceType="Unknown","function"==typeof e.getUUID?this.UUID=e.getUUID():this.UUID="NoFABLESVC-".concat(Math.floor(89999*Math.random()+1e4)),this.Hash="string"==typeof i?i:"".concat(this.UUID),this.log=this.fable.log,this.servicesMap=this.fable.servicesMap,this.services=this.fable.services}}_defineProperty(o,"isFableService",!0),t.exports=o,t.exports.CoreServiceProviderBase=e("./Fable-ServiceProviderBase-Preinit.js")},{"./Fable-ServiceProviderBase-Preinit.js":1}],3:[function(e,t,i){const o=e("fable-serviceproviderbase"),n={DefaultRenderable:!1,DefaultDestinationAddress:!1,DefaultTemplateRecordAddress:!1,ViewIdentifier:"DEFAULT",InitializeOnLoad:!0,RenderOnLoad:!0,Templates:[],DefaultTemplates:[],Renderables:[],Manifests:{}};t.exports=class extends o{constructor(e,t,i){super(e,Object.assign({},JSON.parse(JSON.stringify(n)),t),i),this.serviceType="PictView",this.pict=this.fable,this.AppData=this.fable.AppData;for(let e=0;e<this.options.Templates.length;e++){let t=this.options.Templates[e];t.hasOwnProperty("Hash")&&t.hasOwnProperty("Template")?(t.Source||(t.Source="PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," options object.")),this.fable.TemplateProvider.addTemplate(t.Hash,t.Template,t.Source)):this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not load Template ").concat(e," in the options array."),t)}for(let e=0;e<this.options.DefaultTemplates.length;e++){let t=this.options.DefaultTemplates[e];t.hasOwnProperty("Postfix")&&t.hasOwnProperty("Template")?(t.Source||(t.Source="PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," options object.")),this.fable.TemplateProvider.addDefaultTemplate(t.Prefix,t.Postfix,t.Template,t.Source)):this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not load Default Template ").concat(e," in the options array."),t)}this.renderables={};for(let e=0;e<this.options.Renderables.length;e++){let t=this.options.Renderables[e];t.hasOwnProperty("RenderableHash")&&t.hasOwnProperty("TemplateHash")?this.renderables[t.RenderableHash]=t:this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not load Renderable ").concat(e," in the options array."),t)}}onBeforeInitialize(e){return!0}initialize(e){return!0}onAfterInitialize(e){return!0}initialize(){this.onBeforeInitialize(),this.log.info("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," beginning initialization...")),this.internalInitialize(),this.log.info("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," initialization complete.")),this.onAfterInitialRender()}onBeforeRender(e,t,i){}render(e,t,i){let o="string"==typeof e?e:"string"==typeof this.options.DefaultRenderable&&this.options.DefaultRenderable;if(!o)return this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render ").concat(o," (param ").concat(e,") because it is not a valid renderable.")),!1;let n=this.renderables[o];if(!n)return this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render ").concat(o," (param ").concat(e,") because it does not exist.")),!1;let s="string"==typeof t?t:"string"==typeof n.ContentDestinationAddress?n.ContentDestinationAddress:"string"==typeof this.options.DefaultDestinationAddress&&this.options.DefaultDestinationAddress;if(!s)return this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render ").concat(o," (param ").concat(e,") because it does not have a valid destination address.")),!1;let r="string"==typeof i?i:"string"==typeof n.RecordAddress?n.RecordAddress:"string"==typeof this.options.DefaultTemplateRecordAddress&&this.options.DefaultTemplateRecordAddress,a="string"==typeof r?this.fable.DataProvider.getDataByAddress(r):void 0;this.onBeforeRender(n,s,a);let c=this.fable.parseTemplateByHash(n.TemplateHash,a);this.fable.ContentAssignment.assignContent(s,c),this.onAfterRender(n,s,a,c)}renderAsync(e,t,i,o){let n="string"==typeof e&&e;if(!n)return this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not asynchronously render ").concat(n," (param ").concat(e,"because it is not a valid renderable.")),o(Error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not asynchronously render ").concat(n," (param ").concat(e,"because it is not a valid renderable.")));let s=this.renderables[n];if(!s)return this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render ").concat(n," (param ").concat(e,") because it does not exist.")),o(Error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render ").concat(n," (param ").concat(e,") because it does not exist.")));let r="string"==typeof t?t:"string"==typeof s.ContentDestinationAddress?s.ContentDestinationAddress:"string"==typeof this.options.DefaultDestinationAddress&&this.options.DefaultDestinationAddress;if(!r)return this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render ").concat(n," (param ").concat(e,") because it does not have a valid destination address.")),o(Error("Could not render ".concat(n)));let a="string"==typeof i?i:"string"==typeof s.RecordAddress?s.RecordAddress:"string"==typeof this.options.DefaultTemplateRecordAddress&&this.options.DefaultTemplateRecordAddress,c="string"==typeof a?this.fable.DataProvider.getDataByAddress(a):void 0;this.onBeforeRender(s,r,c),this.fable.parseTemplateByHash(s.TemplateHash,c,((t,i)=>t?(this.log.error("PictView [".concat(this.UUID,"]::[").concat(this.Hash,"] ").concat(this.options.ViewIdentifier," could not render (asynchronously) ").concat(n," (param ").concat(e,") because it did not parse the template."),t),o(t)):(this.fable.ContentAssignment.assignContent(r,i),this.onAfterRender(s,r,c,i),o(null,i))))}onAfterRender(){return!0}}},{"fable-serviceproviderbase":2}]},{},[3])(3)}));
//# sourceMappingURL=pict-view.min.js.map
